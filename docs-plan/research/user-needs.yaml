# User Needs Analysis
# Generated: 2026-01-01
# Source: Codebase exploration and inference

user_personas:
  - name: "Flow SDK Consumer"
    goal: "Build declarative AI workflows using YAML + TypeScript node types"
    knowledge_level: "beginner-intermediate"
    key_tasks:
      - "Create and run a Flow from YAML"
      - "Configure basic nodes and bindings"
      - "Subscribe to Hub events"
      - "Handle agent responses"
    pain_points:
      - "Understanding kernel architecture"
      - "Flow vs legacy runtime differences"
      - "A3 binding syntax"
      - "When expressions in YAML"

  - name: "Node Type Developer"
    goal: "Extend Flow with custom nodes implementing NodeTypeDefinition"
    knowledge_level: "intermediate-advanced"
    key_tasks:
      - "Implement NodeTypeDefinition interface"
      - "Define input/output schemas with Zod"
      - "Register nodes with NodeRegistry"
      - "Handle capabilities and lifecycle"
    pain_points:
      - "Hub event bus integration"
      - "Schema validation patterns"
      - "Capabilities declaration"
      - "Binding resolution internals"

  - name: "Core Contributor"
    goal: "Implement spec-conformant kernel features, maintain alignment"
    knowledge_level: "advanced"
    key_tasks:
      - "Read and implement from specs"
      - "Write conformance tests"
      - "Record/replay golden fixtures"
      - "Navigate spec→test→code traceability"
    pain_points:
      - "Traceability between specs/tests/code"
      - "Conformance validation workflow"
      - "Fixture recording process"
      - "Understanding oharnes commands"

user_journeys:
  - persona: "Flow SDK Consumer"
    journey: "First-time setup"
    steps:
      - "Install package"
      - "Create first YAML flow"
      - "Run and see output"
      - "Modify and iterate"
    docs_needed:
      - "Getting started quickstart"
      - "YAML schema reference"
      - "First flow tutorial"

  - persona: "Flow SDK Consumer"
    journey: "Build production flow"
    steps:
      - "Design flow structure"
      - "Implement custom nodes"
      - "Add error handling"
      - "Write tests"
      - "Deploy"
    docs_needed:
      - "Custom node guide"
      - "Error handling patterns"
      - "Testing guide"
      - "Deployment guide"

  - persona: "Node Type Developer"
    journey: "Create custom node"
    steps:
      - "Understand NodeTypeDefinition"
      - "Define schemas"
      - "Implement run method"
      - "Register with NodeRegistry"
      - "Test the node"
    docs_needed:
      - "Node development guide"
      - "Schema validation reference"
      - "Hub integration guide"

  - persona: "Core Contributor"
    journey: "Implement new feature"
    steps:
      - "Read spec requirements"
      - "Write failing tests"
      - "Implement feature"
      - "Record golden fixtures"
      - "Pass conformance gates"
    docs_needed:
      - "Contributor setup guide"
      - "Spec→code workflow"
      - "Testing infrastructure docs"
      - "oharnes command reference"

common_operations:
  - operation: "Create and run a Flow"
    frequency: "every project"
    complexity: "medium"
    current_docs: "partial"
    description: "Parse YAML → register nodes → execute via FlowRuntime"

  - operation: "Write custom nodes"
    frequency: "common"
    complexity: "medium-high"
    current_docs: "missing"
    description: "Implement NodeTypeDefinition with schemas/run method"

  - operation: "Subscribe to Hub events"
    frequency: "every integration"
    complexity: "low-medium"
    current_docs: "partial"
    description: "Listen to agent/harness/flow lifecycle events"

  - operation: "Handle bidirectional messaging"
    frequency: "advanced use"
    complexity: "high"
    current_docs: "missing"
    description: "Use inbox/sendToRun for channels (voice/console/websocket)"

  - operation: "Test with fixtures"
    frequency: "every feature"
    complexity: "medium"
    current_docs: "partial"
    description: "Record/replay golden fixtures for deterministic tests"

contributor_needs:
  - area: "Spec→Code traceability"
    importance: "critical"
    description: "How docs map to test-specs → replay tests → live scripts"

  - area: "Conformance workflow"
    importance: "critical"
    description: "Step-by-step: write spec → record fixture → TDD loop → gates"

  - area: "Architecture mental model"
    importance: "important"
    description: "Kernel primitives (Hub/FlowRuntime/Agent/Channel) vs Flow layer"

  - area: "oharnes command system"
    importance: "important"
    description: "How to use the development workflow commands"

documentation_gaps:
  - gap: "No Getting Started guide"
    severity: "critical"
    description: "Users need 'zero to first flow' quickstart with runnable examples"

  - gap: "Missing API reference"
    severity: "critical"
    description: "Protocol types exist but lack comprehensive API docs with examples"

  - gap: "Unclear error handling"
    severity: "high"
    description: "No guide on common errors, debugging flows, troubleshooting binding resolution"

  - gap: "Channel integration cookbook"
    severity: "high"
    description: "How to build console/websocket/voice channels is scattered"

  - gap: "Migration guide missing"
    severity: "medium"
    description: "No docs on legacy → Flow-only architecture transition"

faq_candidates:
  - question: "How do I create my first Flow?"
    answer_location: "tutorials/first-flow"

  - question: "What's the difference between Harness and Flow?"
    answer_location: "explanation/architecture"

  - question: "How do I write a custom node?"
    answer_location: "how-to/custom-nodes"

  - question: "How do I subscribe to events from the Hub?"
    answer_location: "how-to/hub-events"

  - question: "How do I test my flows?"
    answer_location: "how-to/testing"

  - question: "What does A3 binding mean?"
    answer_location: "reference/bindings"
