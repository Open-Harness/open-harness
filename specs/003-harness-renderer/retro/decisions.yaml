agent: decision-controller
timestamp: "2025-12-26T14:30:00Z"
feature: 003-harness-renderer
spec_directory: specs/003-harness-renderer

decisions:
  - root_cause_id: RC001
    root_cause_title: "Prototype in context caused architectural divergence"
    decision: "Documentation only"
    score: null
    implementation:
      - "Add documentation warning users not to have prototype code in workspace during spec-driven implementation"
      - "Document best practice: move prototypes out of context or use separate branches"
    user_notes: "User indicated this is a minor issue that doesn't require system changes - just documentation"

  - root_cause_id: RC003
    root_cause_title: "Spec-kit /implement has no verification gates"
    grouped_with: RC005
    decision: "Hybrid: Context Scout + Verification Gates"
    score: 4.1
    implementation:
      - "Create new /oharnes.implement command using controller pattern"
      - "Create Context Scout sub-agent: determines minimal context per task"
      - "Create Task Implementer sub-agent: receives only relevant context"
      - "Create Verification sub-agent: confirms paths match, tests pass"
      - "Add verification gates to controller: pre-commit test execution, task completion check"
      - "Add --skip-tests flag for override"
    user_notes: "User emphasized: Don't modify canonical spec-kit commands. Create our own opinionated commands. Root cause is lack of systematic context loading, not just missing verification."
    key_insight: "Reactive verification catches problems after. Proactive context loading prevents problems before."

  - root_cause_id: RC005
    root_cause_title: "Tasks.md path specifications ignored"
    grouped_with: RC003
    decision: "Addressed via RC003 hybrid solution"
    score: 4.1
    implementation:
      - "Same as RC003 - Context Scout loads task file paths"
      - "Verification sub-agent confirms implemented paths match task specs"
    user_notes: null

  - root_cause_id: RC002
    root_cause_title: "Monologue module completely skipped"
    grouped_with: RC004
    decision: "Dedicated feature cycle (004-monologue-system)"
    score: 4.1
    implementation:
      - "Create 004-monologue-system spec as separate feature"
      - "Implement @AnthropicMonologue decorator as originally designed"
      - "Implement AnthropicMonologueGenerator service"
      - "Migrate from manual emitNarrative() to event-driven generation"
      - "Create monologue/types.ts, prompts.ts, generator.ts, decorator.ts"
    user_notes: null

  - root_cause_id: RC004
    root_cause_title: "Manual narrative emission bypassed decorator architecture"
    grouped_with: RC002
    decision: "Addressed via RC002 dedicated cycle"
    score: 4.1
    implementation:
      - "Same as RC002 - full decorator implementation"
      - "Replace 20+ manual emitNarrative() calls with decorator-based generation"
    user_notes: null

summary:
  total_root_causes: 5
  grouped_decisions: 3
  skipped: 0

decision_groups:
  - name: "Context & Verification (RC003 + RC005)"
    approach: "Hybrid Context Scout + Gates"
    priority: high
    next_action: "Create /oharnes.implement command with sub-agents"

  - name: "Monologue System (RC002 + RC004)"
    approach: "Dedicated feature cycle"
    priority: high
    next_action: "Create 004-monologue-system spec"

  - name: "Prototype Contamination (RC001)"
    approach: "Documentation only"
    priority: low
    next_action: "Add warning to docs/best-practices"
