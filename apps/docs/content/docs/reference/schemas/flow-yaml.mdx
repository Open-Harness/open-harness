---
title: Flow YAML Schema
description: Complete YAML schema for flow definitions
---

# Flow YAML Schema

Complete reference for flow.yaml files.

## Full Schema

```yaml
# Required: Flow name
name: my-flow

# Optional: Description
description: What this flow does

# Optional: Initial state values
state:
  initial:
    key: value

# Required: Array of nodes
nodes:
  - id: node-id           # Required: Unique within flow
    type: node-type       # Required: Registered node type
    input:                # Required: Input bindings
      key: value
      key2: "{{ expression }}"

# Optional: Explicit edges
edges:
  - from: source-node     # Required: Source node ID
    to: target-node       # Required: Target node ID
    when: "expression"    # Optional: JSONata condition
```

## Minimal Example

```yaml
name: hello
nodes:
  - id: greet
    type: claude.agent
    input:
      prompt: "Say hello"
edges: []
```

## Complete Example

```yaml
name: code-review
description: Analyzes and reviews code changes

nodes:
  - id: analyze
    type: claude.agent
    input:
      prompt: |
        Analyze this code for issues:
        {{ flow.input.code }}

  - id: security-check
    type: claude.agent
    input:
      prompt: |
        Check for security vulnerabilities:
        {{ flow.input.code }}

  - id: summarize
    type: claude.agent
    input:
      prompt: |
        Summarize the review findings:
        Analysis: {{ analyze.text }}
        Security: {{ security-check.text }}

edges:
  - from: analyze
    to: summarize
  - from: security-check
    to: summarize
```

## Built-in Node Types

### claude.agent

LLM-backed agent using Claude:

```yaml
- id: assistant
  type: claude.agent
  input:
    prompt: string          # Required: The prompt
    system: string          # Optional: System prompt
    model: string           # Optional: Model name
    maxTokens: number       # Optional: Max tokens
    temperature: number     # Optional: Temperature
```

### echo

Returns the input unchanged (useful for debugging):

```yaml
- id: debug
  type: echo
  input:
    text: "{{ analyze.text }}"
```

### constant

Returns a constant value:

```yaml
- id: config
  type: constant
  input:
    value: "default-value"
```

## Expression Syntax

All string values support JSONata expressions in `{{ }}`:

```yaml
# Flow input reference
prompt: "{{ flow.input.message }}"

# Node output reference
data: "{{ analyze.text }}"

# String concatenation
name: "{{ flow.input.first & ' ' & flow.input.last }}"

# Conditional expression
value: "{{ flow.input.x > 0 ? 'positive' : 'negative' }}"

# Array access
first: "{{ items[0].name }}"
```

## Edge Conditions

Use `when` to conditionally follow edges:

```yaml
edges:
  - from: classify
    to: urgent-handler
    when: "$contains(classify.text, 'urgent')"

  - from: classify
    to: normal-handler
    when: "$not($contains(classify.text, 'urgent'))"
```

## See Also

- [FlowDefinition](/docs/reference/types/flow-definition) — TypeScript type
- [JSONata Syntax](/docs/reference/expressions/syntax) — Expression reference

