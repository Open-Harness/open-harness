---
title: "Test Spec Template"
description: "This is the exact template structure for all `.test-spec.md` files. Copy this template when creating a new test spec."
---

This is the exact template structure for all `.test-spec.md` files. Copy this template when creating a new test spec.

## Template

```markdown
# [Component Name] Test Specification

**Component**: `src/path/to/component.ts`  
**Last Updated**: YYYY-MM-DD  
**Status**: Draft | In Progress | Complete

## Overview

[Brief description of what this component does and what aspects need testing]

## Test Requirements

### R1: [Requirement Name]

**Fixture**: `fixtures/golden/&lt;component>/&lt;fixture-name>.jsonl`  
**Test File**: `tests/replay/&lt;component>.&lt;feature>.test.ts`  
**Test Name**: `"[descriptive test name]"`

**Scenario**:
1. [Step 1 of the scenario]
2. [Step 2 of the scenario]
3. [Step 3 of the scenario]

**Assertions**:
- [Assertion 1 - what must be true]
- [Assertion 2 - what must be true]
- [Assertion 3 - what must be true]

**Fixture Recording**:
```bash
bun scripts/record-fixture.ts &lt;component> &lt;fixture-name>
```

---

### R2: [Requirement Name]

[Same structure as R1]

---

## Live Test (Authoritative)

**Script**: `scripts/live/&lt;component>-live.ts`  
**Requirement**: MUST pass before marking [component] implementation complete  
**Timeout**: [N]s  
**Description**: [What the live test verifies]

**Execution**:
```bash
bun scripts/live/&lt;component>-live.ts
```

**Success Criteria**:
- [Criterion 1]
- [Criterion 2]
- [Criterion 3]

---

## Unit Tests (Pure Logic)

**Test File**: `tests/unit/&lt;component>.unit.test.ts`

[If applicable, describe pure logic tests that don't need fixtures]

**Requirements**:
- [Unit test requirement 1]
- [Unit test requirement 2]

---

## Coverage Checklist

- [ ] R1: [Requirement name]
- [ ] R2: [Requirement name]
- [ ] R3: [Requirement name]
- [ ] Live test script
- [ ] Unit tests for pure logic (if applicable)

---

## Notes

[Implementation-specific notes, edge cases, or special considerations]
```

## Example: Hub Test Spec

```markdown
# Hub Test Specification

**Component**: `src/protocol/hub.ts`  
**Last Updated**: 2025-12-28  
**Status**: Draft

## Overview

Tests for the Hub protocol interface. Hub is the unified bidirectional bus that handles events out (subscribe/emit) and commands in (send/reply/abort).

## Test Requirements

### R1: Event Subscription (Basic)

**Fixture**: `fixtures/golden/hub/subscribe-basic.jsonl`  
**Test File**: `tests/replay/hub.subscribe.test.ts`  
**Test Name**: `"subscribes and receives events"`

**Scenario**:
1. Create a hub instance
2. Subscribe to all events (`"*"`)
3. Emit a `harness:start` event
4. Verify subscriber receives the event with correct envelope

**Assertions**:
- Event has `id`, `timestamp`, `context`, `event` fields
- Event `event.type` matches emitted type
- Event `context.sessionId` is present

**Fixture Recording**:
```bash
bun scripts/record-fixture.ts hub subscribe-basic
```

---

## Live Test (Authoritative)

**Script**: `scripts/live/hub-live.ts`  
**Requirement**: MUST pass before marking Hub implementation complete  
**Timeout**: 30s  
**Description**: Runs all replay scenarios against real implementation (no mocks)

**Execution**:
```bash
bun scripts/live/hub-live.ts
```

**Success Criteria**:
- All replay scenarios pass
- No network calls (Hub is pure)
- Completes in &#60;1s

---

## Coverage Checklist

- [x] R1: Event Subscription (Basic)
- [ ] R2: Event Filtering
- [ ] R3: Context Scoping
- [ ] Live test script
- [ ] Unit tests for filter matching logic

---

## Notes

- Hub is a protocol interface (no implementation in v2)
- Replay tests validate the interface contract
- Live test validates real implementation matches contract
```

## Guidelines

1. **One requirement per R[N]** - Each requirement should be testable independently
2. **Clear scenarios** - Steps should be unambiguous and executable
3. **Specific assertions** - What exactly must be true, not vague descriptions
4. **Fixture names** - Use kebab-case, descriptive: `subscribe-basic`, `scoped-nested`, etc.
5. **Test names** - Use descriptive strings that explain what's being tested
6. **Status tracking** - Update status and checklist as work progresses
