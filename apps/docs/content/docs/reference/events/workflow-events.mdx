---
title: Workflow Events
description: Events for harness, phase, and task lifecycle
---

# Workflow Events

Events emitted during harness execution for tracking workflow progress.

## harness:start

Emitted when a harness begins execution.

```typescript
type HarnessStartEvent = {
  type: "harness:start";
  name: string;
};
```

| Property | Type | Description |
|----------|------|-------------|
| `name` | `string` | Harness name from definition |

### Example

```typescript
hub.subscribe("harness:start", (event) => {
  console.log(`Workflow "${event.event.name}" started`);
});
```

## harness:complete

Emitted when a harness finishes execution.

```typescript
type HarnessCompleteEvent = {
  type: "harness:complete";
  success: boolean;
  durationMs: number;
};
```

| Property | Type | Description |
|----------|------|-------------|
| `success` | `boolean` | Whether execution completed without error |
| `durationMs` | `number` | Total execution time in milliseconds |

### Example

```typescript
hub.subscribe("harness:complete", (event) => {
  const { success, durationMs } = event.event;
  console.log(`Workflow ${success ? "succeeded" : "failed"} in ${durationMs}ms`);
});
```

## phase:start

Emitted when entering a named phase.

```typescript
type PhaseStartEvent = {
  type: "phase:start";
  name: string;
  phaseNumber?: number;
};
```

| Property | Type | Description |
|----------|------|-------------|
| `name` | `string` | Phase name |
| `phaseNumber` | `number?` | Optional sequence number |

### Example

```typescript
// In harness run function
await ctx.phase("Analysis", async () => {
  // phase:start emitted here
  await doAnalysis();
  // phase:complete emitted here
});
```

## phase:complete

Emitted when a phase completes successfully.

```typescript
type PhaseCompleteEvent = {
  type: "phase:complete";
  name: string;
  phaseNumber?: number;
};
```

## phase:failed

Emitted when a phase throws an error.

```typescript
type PhaseFailedEvent = {
  type: "phase:failed";
  name: string;
  error: string;
  stack?: string;
  phaseNumber?: number;
};
```

| Property | Type | Description |
|----------|------|-------------|
| `name` | `string` | Phase name |
| `error` | `string` | Error message |
| `stack` | `string?` | Error stack trace |

### Example

```typescript
hub.subscribe("phase:failed", (event) => {
  console.error(`Phase "${event.event.name}" failed: ${event.event.error}`);
});
```

## task:start

Emitted when entering a task.

```typescript
type TaskStartEvent = {
  type: "task:start";
  taskId: string;
};
```

| Property | Type | Description |
|----------|------|-------------|
| `taskId` | `string` | Task identifier |

### Example

```typescript
await ctx.task("fetch-data", async () => {
  // task:start emitted here
  return await fetchData();
  // task:complete emitted here
});
```

## task:complete

Emitted when a task completes successfully.

```typescript
type TaskCompleteEvent = {
  type: "task:complete";
  taskId: string;
  result?: unknown;
};
```

| Property | Type | Description |
|----------|------|-------------|
| `taskId` | `string` | Task identifier |
| `result` | `unknown?` | Task return value |

## task:failed

Emitted when a task throws an error.

```typescript
type TaskFailedEvent = {
  type: "task:failed";
  taskId: string;
  error: string;
  stack?: string;
};
```

### Example

```typescript
hub.subscribe("task:failed", (event) => {
  console.error(`Task "${event.event.taskId}" failed: ${event.event.error}`);
  if (event.event.stack) {
    console.error(event.event.stack);
  }
});
```

## Event Sequence

Typical execution produces this sequence:

```
harness:start (name: "my-workflow")
  phase:start (name: "Setup")
    task:start (taskId: "init")
    task:complete (taskId: "init")
  phase:complete (name: "Setup")
  phase:start (name: "Processing")
    task:start (taskId: "step-1")
      agent:start
      agent:complete
    task:complete (taskId: "step-1")
  phase:complete (name: "Processing")
harness:complete (success: true, durationMs: 1234)
```

## Context

All workflow events include context:

```typescript
hub.subscribe("task:start", (event) => {
  const { sessionId, phase, task } = event.context;
  console.log(`[${sessionId}] ${phase?.name}/${task?.id}: Starting`);
});
```

## See Also

- [Agent Events](/docs/reference/events/agent-events) - Agent execution events
- [EventContext](/docs/reference/types/event-context) - Context structure
- [executeFlow](/docs/reference/api/execute-flow) - Flow execution
