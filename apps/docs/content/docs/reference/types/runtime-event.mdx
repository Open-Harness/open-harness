---
title: Signal
description: Signal type reference
---

# Signal

All communication in Open Harness uses typed signals.

## Type Definition

```typescript
interface Signal {
  id: string;           // Unique identifier ("sig_abc123")
  name: string;         // Signal name ("analysis:complete")
  payload: unknown;     // Signal-specific data
  timestamp: string;    // ISO timestamp
  source?: {
    agent?: string;     // Emitting agent
    parent?: string;    // Parent signal ID (causality)
  };
}
```

## Signal ID Format

Signal IDs use the format `sig_<random>`:

```typescript
"sig_abc123def456"
```

IDs are unique within a workflow execution.

## Signal Names

Signal names use colon-separated namespaces:

| Namespace | Examples |
|-----------|----------|
| `harness:` | `harness:start`, `harness:end` |
| `agent:` | `agent:activated`, `agent:completed` |
| `provider:` | `provider:start`, `provider:end` |
| `text:` | `text:delta`, `text:complete` |
| `thinking:` | `thinking:delta`, `thinking:complete` |
| `tool:` | `tool:call`, `tool:result` |
| `state:` | `state:analysis:changed` |
| Custom | `analysis:complete`, `review:done` |

## Payload Types

### Harness Signals

```typescript
// harness:start
{ state: TState; agents: string[] }

// harness:end
{
  state: TState;
  metrics: { durationMs: number; activations: number };
  terminatedEarly: boolean;
}
```

### Agent Signals

```typescript
// agent:activated
{ agent: string; triggeredBy: string }

// agent:skipped
{ agent: string; reason: string }

// agent:completed
{ agent: string; output: unknown }
```

### Provider Signals

```typescript
// provider:start
{ model: string }

// provider:end
{
  usage?: { inputTokens: number; outputTokens: number };
  cost?: number;
  sessionId?: string;
}

// provider:error
{ error: string; retryAfter?: number }
```

### Text Signals

```typescript
// text:delta
{ content: string }

// text:complete
{ content: string }
```

### Thinking Signals

```typescript
// thinking:delta
{ content: string }

// thinking:complete
{ content: string }
```

### Tool Signals

```typescript
// tool:call
{ id: string; name: string; input: unknown }

// tool:result
{ id: string; name: string; output: unknown; error?: string }
```

### State Signals

```typescript
// state:{key}:changed
{ value: unknown; previousValue: unknown }
```

## Source Tracking

The `source` field tracks signal origin:

```typescript
{
  name: "analysis:complete",
  source: {
    agent: "analyzer",       // Which agent emitted
    parent: "sig_xyz789",    // Parent signal (trigger)
  },
}
```

Use for causality debugging:

```typescript
const chain = result.signals.filter(s => s.source?.parent === targetId);
```

## Creating Signals

Providers create signals using `createSignal`:

```typescript
import { createSignal } from "@open-harness/core";

yield createSignal("provider:start", { model: "my-model" });
yield createSignal("text:delta", { content: "Hello" });
yield createSignal("provider:end", { usage: { inputTokens: 10, outputTokens: 5 } });
```

## Working with Signals

### Filter by Name

```typescript
const agentSignals = result.signals.filter(s => s.name.startsWith("agent:"));
```

### Extract Text

```typescript
const textComplete = result.signals.find(s => s.name === "text:complete");
const output = textComplete?.payload.content;
```

### Calculate Totals

```typescript
const totalTokens = result.signals
  .filter(s => s.name === "provider:end")
  .reduce((sum, s) => {
    const usage = s.payload.usage || { inputTokens: 0, outputTokens: 0 };
    return sum + usage.inputTokens + usage.outputTokens;
  }, 0);
```

## Type Guards

Use type guards for type-safe access:

```typescript
function isProviderEnd(signal: Signal): signal is Signal & { payload: { usage: Usage } } {
  return signal.name === "provider:end";
}

const providerEnds = result.signals.filter(isProviderEnd);
```

## See Also

<Cards>
  <Card title="Signal System" href="/docs/concepts/event-system">
    Conceptual overview
  </Card>
  <Card title="runReactive" href="/docs/reference/api/runtime">
    Execution API
  </Card>
  <Card title="Signals Reference" href="/docs/reference/api/events">
    All signal types
  </Card>
</Cards>
