---
title: Runtime
description: Execute flows and subscribe to runtime events
---

# Runtime

The Runtime executes a single flow definition and emits events as it runs.

## Creating a Runtime

```typescript
import {
  createRuntime,
  DefaultNodeRegistry,
  parseFlowYaml,
  constantNode,
  echoNode,
} from "@open-harness/sdk";

const flow = parseFlowYaml(`
name: "hello"
nodes:
  - id: a
    type: constant
    input:
      value: "Hello"
  - id: b
    type: echo
    input:
      text: "{{ a.value }}"
edges:
  - from: a
    to: b
`);

const registry = new DefaultNodeRegistry();
registry.register(constantNode);
registry.register(echoNode);

const runtime = createRuntime({ flow, registry });
const snapshot = await runtime.run();

console.log(snapshot.outputs);
```

## Runtime API

### `run(input?)`

Execute the flow to completion:

```typescript
const snapshot = await runtime.run({ name: "World" });
```

### `dispatch(command)`

Send a command into a running flow:

```typescript
runtime.dispatch({ type: "send", runId: "run-123", message: "continue" });
runtime.dispatch({ type: "abort", reason: "user_cancelled" });
```

### `onEvent(listener)`

Subscribe to runtime events:

```typescript
runtime.onEvent((event) => {
  if (event.type === "node:error") {
    console.error(event.error);
  }
});
```

### `getSnapshot()`

Inspect current runtime state:

```typescript
const snapshot = runtime.getSnapshot();
```

## Runtime Options

```typescript
const runtime = createRuntime({
  flow,
  registry,
  store, // Optional RunStore for persistence
  resume: { runId: "run-123" }, // Optional resume
});
```

## See Also

- [Runtime Execution](/docs/reference/api/flow-runtime) — Snapshots and commands
- [Events API](/docs/reference/api/events) — Event types
- [Node Registry](/docs/reference/api/node-registry) — Register node types
