---
title: Runtime
description: Execute flows and subscribe to runtime events
---

# Runtime

The Runtime executes a single flow definition and emits events as it runs.

## Quick Start

**For most cases**, use the simplified APIs:

```typescript
import { runFlow, parseFlowYaml } from "@open-harness/sdk";

// Simplest one-shot execution
const snapshot = await runFlow({
  flow: parseFlowYaml(yamlString),
  input: { name: "World" },
});
```

```typescript
import { createHarness, parseFlowYaml } from "@open-harness/sdk";

// Full control with event handling
const harness = createHarness({
  flow: parseFlowYaml(yamlString),
  onEvent: (event) => console.log(event.type),
});

await harness.run();
harness.runtime.dispatch({ type: "pause" });
```

## Runtime API

For advanced control over execution, use `createRuntime()`:

```typescript
import {
  createRuntime,
  DefaultNodeRegistry,
  parseFlowYaml,
  createDefaultRegistry,
} from "@open-harness/sdk";

const registry = createDefaultRegistry();

const runtime = createRuntime({ flow, registry });
const snapshot = await runtime.run();
```

### `run(input?)`

Execute the flow to completion:

```typescript
const snapshot = await runtime.run({ name: "World" });
```

### `dispatch(command)`

Send a command into a running flow:

```typescript
runtime.dispatch({ type: "send", runId: "run-123", message: "continue" });
runtime.dispatch({ type: "abort", reason: "user_cancelled" });
```

### `onEvent(listener)`

Subscribe to runtime events:

```typescript
runtime.onEvent((event) => {
  if (event.type === "node:error") {
    console.error(event.error);
  }
});
```

### `getSnapshot()`

Inspect current runtime state:

```typescript
const snapshot = runtime.getSnapshot();
```

## Runtime Options

```typescript
const runtime = createRuntime({
  flow,
  registry,
  store, // Optional RunStore for persistence
  resume: { runId: "run-123" }, // Optional resume
});
```

## See Also

- [Runtime Execution](/docs/reference/api/flow-runtime) — Snapshots and commands
- [Events API](/docs/reference/api/events) — Event types
- [Node Registry](/docs/reference/api/node-registry) — Register node types
