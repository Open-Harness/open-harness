---
title: Traceability
description: Mapping specifications to tests to code
---

# Traceability

Traceability connects specifications to tests to implementation. This chain ensures requirements are implemented and tested.

## The Traceability Chain

```
Specification (docs/spec/*.md)
        ↓
Test Specification (tests/spec/*.test-spec.md)
        ↓
Test File (tests/**/*.test.ts)
        ↓
Implementation (src/**/*.ts)
```

Each link connects to the next, creating a traceable path.

## Forward Tracing

### From Spec to Tests

Start with a spec requirement:

```markdown
<!-- docs/spec/hub.md -->
### 3.1 Event Emission

The Hub MUST notify all listeners whose filter matches
the event type when an event is emitted.
```

Find the test spec:

```markdown
<!-- tests/spec/hub.test-spec.md -->
### HUB-001: Event Emission

**From**: docs/spec/hub.md Section 3.1

**Requirement**: Hub MUST notify all matching listeners.

**Tests**:
- Notifies single listener
- Notifies multiple listeners
- Skips non-matching listeners
```

Find the tests:

```typescript
// tests/unit/hub.test.ts

// Spec: docs/spec/hub.md Section 3.1
// Test Spec: HUB-001
describe("HUB-001: Event Emission", () => {
  test("notifies single listener", () => { ... });
  test("notifies multiple listeners", () => { ... });
  test("skips non-matching listeners", () => { ... });
});
```

### From Tests to Implementation

Find the implementation:

```typescript
// src/engine/hub.ts

/**
 * Emits an event to all matching listeners.
 * @see docs/spec/hub.md Section 3.1
 */
emit(event: BaseEvent): void {
  for (const { filter, listener } of this.listeners) {
    if (matchesFilter(event.type, filter)) {
      listener(enriched);
    }
  }
}
```

## Backward Tracing

### From Code to Spec

Start with code:

```typescript
// src/engine/hub.ts
emit(event: BaseEvent): void {
```

Look for JSDoc reference:

```typescript
/**
 * @see docs/spec/hub.md Section 3.1
 */
```

Or search for uses in tests:

```bash
grep -r "emit(" tests/
```

Find test spec in test file comments:

```typescript
// Test Spec: HUB-001
```

Find requirement in test spec:

```markdown
**From**: docs/spec/hub.md Section 3.1
```

## Traceability Documentation

### In Test Files

```typescript
// tests/unit/hub.test.ts

/**
 * Hub Unit Tests
 *
 * Spec: docs/spec/hub.md
 * Test Spec: tests/spec/hub.test-spec.md
 */

// HUB-001: Event Emission
// Spec: docs/spec/hub.md Section 3.1
describe("HUB-001: Event Emission", () => {
```

### In Implementation

```typescript
// src/engine/hub.ts

/**
 * Hub implementation.
 *
 * @see docs/spec/hub.md
 */
export class HubImpl implements Hub {
  /**
   * Emits event to matching listeners.
   *
   * @see docs/spec/hub.md Section 3.1
   */
  emit(event: BaseEvent): void {
```

### In Test Specs

```markdown
<!-- tests/spec/hub.test-spec.md -->

# Hub Test Specification

Source: docs/spec/hub.md
Implementation: src/engine/hub.ts
Tests: tests/unit/hub.test.ts

## HUB-001: Event Emission

**Spec Section**: 3.1
**Test File**: tests/unit/hub.test.ts line 15
**Implementation**: src/engine/hub.ts line 67
```

## Coverage Mapping

### Create Coverage Matrix

| Spec Section | Requirement | Test Spec | Tests | Status |
|--------------|-------------|-----------|-------|--------|
| Hub 3.1 | Notify listeners | HUB-001 | 3 | ✓ |
| Hub 3.2 | Context propagation | HUB-002 | 2 | ✓ |
| Hub 3.3 | Scoped execution | HUB-003 | 4 | ✓ |
| Hub 3.4 | Async iteration | HUB-004 | 0 | Missing |

### Identify Gaps

Rows with "Missing" need tests:

```
Hub 3.4 - No tests for async iteration
```

Create issues to address gaps.

## Navigation Patterns

### Finding What Tests a Requirement

```bash
# Search for spec reference
grep -r "docs/spec/hub.md Section 3.1" tests/
```

### Finding What Implements a Requirement

```bash
# Search for spec reference
grep -r "docs/spec/hub.md Section 3.1" src/
```

### Finding Requirements for Code

```bash
# Look for @see tags
grep -B5 "emit(" src/engine/hub.ts | grep "@see"
```

## Tools

### IDE Navigation

- Click spec links in comments
- Search for requirement IDs (HUB-001)
- Use symbol search for function names

### Scripts

```bash
# List all test spec requirements
grep -r "^### [A-Z]+-[0-9]+" tests/spec/

# List all spec references in tests
grep -r "Spec:" tests/ | grep "docs/spec/"

# Find unlinked tests
grep -L "Test Spec:" tests/**/*.test.ts
```

## Maintaining Traceability

### When Adding Features

1. Update/add to spec
2. Create test spec entry
3. Write tests with references
4. Implement with references

### When Fixing Bugs

1. Find related spec section
2. Add test case to test spec
3. Write failing test
4. Fix implementation

### When Refactoring

1. Keep references intact
2. Update line numbers if needed
3. Verify tests still pass

## Next Steps

- [Reading Specs](/docs/contributing/specifications/reading-specs) - Understanding specs
- [Spec to Code](/docs/contributing/specifications/spec-to-code) - Implementation
- [Conformance Testing](/docs/contributing/development/conformance) - Testing
