---
title: Reading Specifications
description: How to read and understand kernel specifications
---

# Reading Specifications

The kernel has internal specifications that define expected behavior. Understanding these specs is essential for contributing.

## Spec Location

Specifications live in the kernel package:

```
packages/kernel/docs/
├── spec/                  # Specifications
│   ├── hub.md            # Hub specification
│   ├── harness.md        # Harness specification
│   └── flow.md           # Flow specification
└── adr/                   # Architecture decisions
    ├── 001-event-driven.md
    └── 002-binding-syntax.md
```

## Spec Structure

### Header

```markdown
# Hub Specification

Version: 1.0.0
Status: Stable
Last Updated: 2024-01-15
```

### Overview

High-level purpose and scope:

```markdown
## Overview

The Hub is the central event bus for Open Harness.
It provides pub/sub messaging with context propagation.
```

### Requirements

Specific, testable requirements:

```markdown
## Requirements

### 3.1 Event Emission

The Hub MUST notify all listeners whose filter matches
the event type when an event is emitted.

### 3.2 Context Propagation

The Hub MUST propagate EventContext through scoped
executions using AsyncLocalStorage.
```

### Examples

Code examples showing expected behavior:

```markdown
## Examples

### Basic Emission

```typescript
const hub = createHub();
hub.subscribe("test", (e) => console.log(e));
hub.emit({ type: "test" });
// Logs the enriched event
```
```

## RFC 2119 Keywords

Specs use RFC 2119 keywords with specific meanings:

| Keyword | Meaning |
|---------|---------|
| **MUST** | Absolute requirement |
| **MUST NOT** | Absolute prohibition |
| **SHOULD** | Recommended, with exceptions |
| **SHOULD NOT** | Not recommended, with exceptions |
| **MAY** | Optional |

### Reading Requirements

```markdown
The Hub MUST notify all matching listeners.
```

→ This is mandatory. Tests must verify it. Code must implement it.

```markdown
The Hub SHOULD buffer events during initialization.
```

→ Recommended but not mandatory. Document exceptions.

```markdown
The Hub MAY support glob patterns for filtering.
```

→ Optional. Implement if useful.

## Reading for Implementation

### Finding Requirements

Look for capitalized keywords:

```markdown
3.1 Event Emission

The Hub MUST notify all listeners...
The Hub MUST NOT modify the original event...
The Hub SHOULD emit events synchronously...
```

Extract as checklist:
- [ ] Notify all listeners
- [ ] Don't modify original event
- [ ] Emit synchronously (recommended)

### Understanding Context

Read surrounding text for context:

```markdown
3.1 Event Emission

Events are the primary communication mechanism. When
emitted, they travel to all interested subscribers.

The Hub MUST notify all listeners whose filter matches
the event type.

This enables decoupled component communication.
```

The context explains *why* the requirement exists.

### Following References

Specs reference each other:

```markdown
See Section 4.2 for filter matching rules.
See the Event Specification for event structure.
```

Follow references for complete understanding.

## Spec Categories

### Protocol Specs

Define interfaces and types:

```markdown
## Hub Interface

```typescript
interface Hub {
  emit(event: BaseEvent): void;
  subscribe(filter: EventFilter, listener: EventListener): () => void;
  // ...
}
```
```

### Behavior Specs

Define runtime behavior:

```markdown
## Emission Behavior

When emit() is called:
1. Current context is captured
2. Event is enriched with context
3. All matching listeners are notified
4. Errors in listeners are caught
```

### Flow Specs

Define execution flow:

```markdown
## Node Execution Order

1. Registration lookup
2. Condition check
3. Input resolution
4. Input validation
5. Execution
6. Output validation
7. Output capture
```

## Architecture Decision Records

ADRs document design decisions:

```markdown
# ADR 001: Event-Driven Architecture

## Status

Accepted

## Context

We need a way for components to communicate...

## Decision

Use an event-driven architecture with a central Hub...

## Consequences

- Decoupled components
- Easy testing with fixtures
- Increased indirection
```

### Reading ADRs

ADRs explain *why* things are designed a certain way:

1. **Context**: What problem we faced
2. **Decision**: What we chose
3. **Consequences**: Trade-offs we accepted

Reference ADRs when questioning design.

## Finding Information

### By Feature

"How should binding resolution work?"
→ `docs/spec/flow.md` Section 4 (Bindings)

### By Type

"What is the Hub interface?"
→ `docs/spec/hub.md` Section 2 (Interface)

### By Behavior

"What happens when a node fails?"
→ `docs/spec/flow.md` Section 6 (Error Handling)

### By Decision

"Why use double braces for bindings?"
→ `docs/adr/002-binding-syntax.md`

## Next Steps

- [Spec to Code](/contributing/specifications/spec-to-code) - Implementation
- [Traceability](/contributing/specifications/traceability) - Tracking
- [Conformance Testing](/contributing/development/conformance) - Testing
