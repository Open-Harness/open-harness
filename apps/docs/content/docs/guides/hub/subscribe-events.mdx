---
title: How to Subscribe to Hub Events
description: Subscribe to events from the Hub event bus
---

# How to Subscribe to Hub Events

Observe flow execution by subscribing to Hub events.

## Create and Subscribe

```typescript
import { createHub } from "@open-harness/kernel";

const hub = createHub();

// Subscribe to all events
hub.subscribe("*", (event) => {
  console.log(event.event.type, event.event);
});
```

## Subscribe to Specific Events

```typescript
// Task lifecycle
hub.subscribe("task:start", (event) => {
  console.log("Node starting:", event.event.taskId);
});

hub.subscribe("task:complete", (event) => {
  console.log("Node complete:", event.event.taskId);
});

// Agent text output
hub.subscribe("agent:text", (event) => {
  process.stdout.write(event.event.content);
});
```

## Event Handler Signature

```typescript
hub.subscribe("task:complete", (enrichedEvent) => {
  // Event payload
  const { type, taskId, result } = enrichedEvent.event;

  // Event context (session, phase, agent)
  const { sessionId, phase, taskContext } = enrichedEvent.context;

  // Metadata
  const timestamp = enrichedEvent.timestamp;
});
```

## Unsubscribe

```typescript
// Subscribe returns cleanup function
const unsubscribe = hub.subscribe("agent:text", handler);

// Later: unsubscribe
unsubscribe();
```

## Pattern Matching

```typescript
// All task events
hub.subscribe("task:*", (event) => {
  console.log("Task event:", event.event.type);
});

// All events from specific pattern
hub.subscribe("agent:*", (event) => {
  console.log("Agent event:", event.event.type);
});
```

## Common Event Types

| Event | When | Payload |
|-------|------|---------|
| `task:start` | Node begins | `{ taskId }` |
| `task:complete` | Node finishes | `{ taskId, result }` |
| `task:failed` | Node errors | `{ taskId, error }` |
| `task:skipped` | Node skipped | `{ taskId, reason }` |
| `agent:text` | Agent output | `{ content }` |
| `narrative` | Progress info | `{ text }` |
| `session:complete` | Flow ends | `{ outputs }` |

## Multiple Subscriptions

```typescript
// Each returns independent unsubscribe
const unsub1 = hub.subscribe("task:start", startHandler);
const unsub2 = hub.subscribe("task:complete", completeHandler);
const unsub3 = hub.subscribe("agent:text", textHandler);

// Cleanup all
function cleanup() {
  unsub1();
  unsub2();
  unsub3();
}
```

## Related

- [Emit Events](/docs/guides/hub/emit-events) - Send custom events
- [Event Context](/docs/guides/hub/event-context) - Context propagation
- [Hub Events Tutorial](/docs/learn/hub-events) - Full tutorial
