---
title: How to Conditionally Execute Nodes
description: Skip nodes based on runtime conditions
---

# How to Conditionally Execute Nodes

Use `when` clauses to conditionally execute nodes.

## Basic When Clause

```yaml
nodes:
  - id: premium-feature
    type: my-node
    input:
      data: "{{flow.input.data}}"
    when:
      equals:
        var: flow.input.isPremium
        value: true
```

## When Operators

### equals

```yaml
when:
  equals:
    var: flow.input.status
    value: "active"
```

### and

```yaml
when:
  and:
    - equals:
        var: flow.input.enabled
        value: true
    - equals:
        var: flow.input.hasPermission
        value: true
```

### or

```yaml
when:
  or:
    - equals:
        var: flow.input.role
        value: "admin"
    - equals:
        var: flow.input.role
        value: "moderator"
```

### not

```yaml
when:
  not:
    equals:
      var: flow.input.disabled
      value: true
```

## Reference Node Outputs

```yaml
nodes:
  - id: classifier
    type: classify
    input:
      text: "{{flow.input.query}}"

  - id: technical-handler
    type: llm
    input:
      prompt: "{{flow.input.query}}"
    when:
      equals:
        var: classifier.output.category
        value: "technical"

  - id: general-handler
    type: llm
    input:
      prompt: "{{flow.input.query}}"
    when:
      not:
        equals:
          var: classifier.output.category
          value: "technical"

edges:
  - from: classifier
    to: technical-handler
  - from: classifier
    to: general-handler
```

## Complex Conditions

```yaml
when:
  and:
    - or:
        - equals:
            var: flow.input.plan
            value: "pro"
        - equals:
            var: flow.input.plan
            value: "enterprise"
    - not:
        equals:
          var: flow.input.suspended
          value: true
```

## Debug Conditions

Subscribe to see which nodes were skipped:

```typescript
hub.subscribe("task:skipped", (event) => {
  console.log("Skipped:", event.event.taskId);
  console.log("Reason:", event.event.reason);
});
```

## Common Patterns

### Feature Flags

```yaml
when:
  equals:
    var: flow.input.features.newUI
    value: true
```

### A/B Testing

```yaml
when:
  equals:
    var: flow.input.experimentGroup
    value: "B"
```

### Error Recovery

```yaml
when:
  equals:
    var: primary.output.skipped
    value: true
```

## Related

- [Conditional Flows Tutorial](/learn/advanced/conditional-flows) - Full tutorial
- [WhenExpr Reference](/reference/types/when-expr) - Expression schema
- [Error Handling](/guides/flows/error-handling) - Handle failures
