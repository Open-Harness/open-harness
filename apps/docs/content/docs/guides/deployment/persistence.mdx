---
title: Persistence Configuration
description: Configure SQLite and custom stores for production
---

# Persistence Configuration

Configure persistent storage for production deployments.

## SQLite Store

The default persistent store:

```typescript
import { SqliteRunStore } from "@open-harness/sdk";

const store = new SqliteRunStore("./data/runs.db", {
  // Vacuum database on startup
  vacuum: true,
  // Max events per run before archival
  maxEventsPerRun: 10000,
});
```

## Custom Store

Implement the `RunStore` interface:

```typescript
import { RunStore, RuntimeEvent, RunMetadata } from "@open-harness/sdk";

class PostgresRunStore implements RunStore {
  async saveEvent(runId: string, event: RuntimeEvent): Promise<void> {
    await this.pool.query(
      "INSERT INTO events (run_id, data) VALUES ($1, $2)",
      [runId, JSON.stringify(event)]
    );
  }

  async getEvents(runId: string): Promise<RuntimeEvent[]> {
    const result = await this.pool.query(
      "SELECT data FROM events WHERE run_id = $1 ORDER BY id",
      [runId]
    );
    return result.rows.map(r => JSON.parse(r.data));
  }

  async getRun(runId: string): Promise<RunMetadata | null> {
    // Implementation
  }
}
```

## Store Selection

| Store | Pros | Cons |
|-------|------|------|
| Memory | Fast, simple | No persistence |
| SQLite | Single file, no server | Single-process |
| PostgreSQL | Scalable, multi-process | Setup complexity |

## Next Steps

- [Production Deployment](/docs/guides/deployment/production) — Full deployment guide
- [Run Store API](/docs/reference/api/run-store) — API reference
