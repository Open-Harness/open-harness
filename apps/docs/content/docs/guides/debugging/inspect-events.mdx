---
title: How to Inspect Events
description: Inspect the Hub event stream for debugging
---

# How to Inspect Events

Monitor and analyze Hub events during flow execution.

## Log All Events

```typescript
const hub = createHub();

hub.subscribe("*", (event) => {
  console.log(JSON.stringify({
    timestamp: event.timestamp,
    type: event.event.type,
    sessionId: event.context.sessionId,
    taskId: event.context.taskContext?.taskId,
    payload: event.event
  }, null, 2));
});
```

## Filter by Type

```typescript
// Only task lifecycle events
hub.subscribe("task:*", (event) => {
  console.log(`[${event.event.type}]`, event.event.taskId);
});

// Only agent output
hub.subscribe("agent:text", (event) => {
  console.log("Agent:", event.event.content);
});
```

## Structured Logging

```typescript
function createStructuredLogger(hub: Hub) {
  const logs: LogEntry[] = [];

  hub.subscribe("*", (event) => {
    logs.push({
      timestamp: event.timestamp,
      level: getLogLevel(event.event.type),
      type: event.event.type,
      sessionId: event.context.sessionId,
      taskId: event.context.taskContext?.taskId,
      message: formatMessage(event.event)
    });
  });

  return {
    getLogs: () => logs,
    exportJSON: () => JSON.stringify(logs, null, 2),
    exportCSV: () => logsToCSV(logs)
  };
}

function getLogLevel(type: string): string {
  if (type.includes("error") || type.includes("failed")) return "ERROR";
  if (type.includes("warning")) return "WARN";
  return "INFO";
}
```

## Event Timeline

```typescript
interface TimelineEntry {
  time: number;
  type: string;
  taskId?: string;
  details: any;
}

function createTimeline(hub: Hub) {
  const startTime = Date.now();
  const timeline: TimelineEntry[] = [];

  hub.subscribe("*", (event) => {
    timeline.push({
      time: event.timestamp - startTime,
      type: event.event.type,
      taskId: event.context.taskContext?.taskId,
      details: event.event
    });
  });

  return {
    getTimeline: () => timeline,
    print: () => {
      for (const entry of timeline) {
        const task = entry.taskId ? `[${entry.taskId}]` : "";
        console.log(`+${entry.time}ms ${task} ${entry.type}`);
      }
    }
  };
}
```

## Export to File

```typescript
import { writeFileSync } from "fs";

async function exportEvents(hub: Hub, outputPath: string) {
  const events: any[] = [];

  hub.subscribe("*", (e) => events.push(e));

  // After execution
  writeFileSync(outputPath, JSON.stringify(events, null, 2));
  console.log(`Exported ${events.length} events to ${outputPath}`);
}
```

## Pretty Print

```typescript
function prettyPrintEvent(event: EnrichedEvent) {
  const prefix = getEventIcon(event.event.type);
  const taskId = event.context.taskContext?.taskId || "flow";

  console.log(`${prefix} [${taskId}] ${event.event.type}`);

  if (event.event.type === "agent:text") {
    console.log(`   "${event.event.content.substring(0, 50)}..."`);
  } else if (event.event.type === "task:failed") {
    console.log(`   Error: ${event.event.error}`);
  }
}

function getEventIcon(type: string): string {
  const icons: Record<string, string> = {
    "task:start": "â–¶",
    "task:complete": "âœ“",
    "task:failed": "âœ—",
    "task:skipped": "âŠ˜",
    "agent:text": "ðŸ’¬",
    "narrative": "ðŸ“"
  };
  return icons[type] || "â€¢";
}
```

## Session Filtering

```typescript
function createSessionInspector(hub: Hub, targetSessionId: string) {
  const events: EnrichedEvent[] = [];

  hub.subscribe("*", (event) => {
    if (event.context.sessionId === targetSessionId) {
      events.push(event);
    }
  });

  return { events };
}
```

## Related

- [Debug Flows](/guides/debugging/debug-flows) - Full debugging guide
- [Common Errors](/guides/debugging/common-errors) - Error reference
- [Subscribe Events](/guides/hub/subscribe-events) - Event basics
